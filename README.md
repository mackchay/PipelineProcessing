# Требования

## Идея задачи

Конвейер состоит из связанных между собой узлов. Узел характеризуется набором входных и выходных каналов, по которым могут передаваться объекты. Узел ожидает появления определенного набора объектов на своих входных каналах, после чего проводит вычисления и порождает объект(-ы) на своих выходных каналах (не обязательно всех). Например, узел "сумматор" имеет два входных канала и один выходной. Получая по одному объекту с каждого входного канала, он их суммирует и результат отправляет в выходной канал. При этом, если входные каналы не будут синхронизованы, то в одном из них могут "скапливаться" данные, ожидающие обработки. Определите проблемно-специфичный язык (DSL) для работы с конвейерными схемами обработки данных, поддерживающий следующие элементы:

- узлы с набором входных и выходных каналов;
- статическую типизацию каналов;
- формирование конвейера в форме связанных узлов в соответствии с типизацией;
- запуск конвейера и обработку данных;
- параллельное исполнение отдельных узлов конвейера;
- использование одинаковых узлов для формирования разных конвейеров.

## Модельная задача

Демонстрируется работа разработанной вычислительной модели на примере обработки фотографий с симуляцией работы фильтров/преобразований без их реального использования.

## Дополнительные требования: Сетевое взаимодействие между узлами через Socket API

Требуется реализовать прямое сетевое взаимодействие между узлами конвейера через TCP/IP сокеты, исключив промежуточные каналы (Channel) как отдельные сущности. Каждый узел должен иметь возможность как принимать соединения (серверная часть), так и устанавливать соединения с другими узлами (клиентская часть).

# Архитектура

В рамках задания будут реализованы следующие архитектурные слои:

## Конфигурационный слой (Configuration Layer)

### DSL разбор и валидация:
- парсинг JSON-конфигурации конвейера;
- построение абстрактного графа узлов и соединений;
- статическая проверка корректности связей (типовая безопасность, отсутствие циклов);
- валидация сетевых параметров (порты, хосты, таймауты).

### Модель конфигурации:
- DTO-классы для сериализации/десериализации JSON;
- маппинг DSL-конструкций на runtime-объекты;
- разрешение зависимостей между узлами.

## Сетевой слой (Network Layer)

### Транспортная абстракция
- унифицированный интерфейс для сетевого взаимодействия;
- фабрика сокет-соединений;
- пул соединений с кэшированием и health-check.

### Протокол обмена:
Это структурированные сообщения с заголовками и полезной нагрузкой;

### Управление соединениями
- установка и поддержание TCP-соединений;
- обработка разрывов с автоматическим отключением;
- балансировка нагрузки между репликами узлов.

## Runtime-слой (Execution Layer)

Граф исполнения это трансформация конфигурационного графа в исполняемый;

Жизненный цикл состоит из координированного запуска/остановки всех узлов конвейера и graceful shutdown с завершением обработки текущих данных

Координация исполнения выполняется с распределение потоков между узлами и синхронизация начала обработки;

## DSL-слой (Domain-Specific Language)

### Декларативное описание конвейера
- JSON-схема для описания топологии;
- параметризация узлов через конфигурацию;
- поддержка шаблонов и reuse компонентов.

### Валидация схемы
- проверка корректности на этапе загрузки;
- верификация доступности сетевых endpoint'ов;
- проверка ресурсов.

# Назначение ответственности

| Исполнитель | Зона ответственности | Функциональность |
|-------------|----------------------|------------------|
| Егор Хасков | Архитектура и реализация | • Реализация узлов в режиме потоков<br>• Реализация сокетов для передачи данных<br>• Организация параллельного исполнения узлов<br>• Реализация точки входа и запуска конвейера |
| Рома Сипатров | Работа с DSL и тестирование | • Реализация DTO<br>• Работа с DSL (schema.json)<br>• Добавление модульных тестов |
